<h1 class="c75 c35" id="h.pq58ai1onyv"><span class="c28 c87"></span></h1><h1 class="c95 c35" id="h.m8rchl8n16k9"><span class="c28 c87">Epis&oacute;dio 17: Conhecendo o m&oacute;dulo CCP - Modo capturar e a interrup&ccedil;&atilde;o associada</span></h1><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Neste episodio veremos o uso do m&oacute;dulo CCP (Capture/Compare/PWM) e especificamente o modo Capture (Capturar).</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O modo Capture tem um registrador de 16 bits composto pelos registradores de 8 bits CCPR1H e CCPR1L, no qual captura a quantidade de ciclos (tempo) sobre o registrador TMR1 quando um evento ocorre sobre o pino RB3/CCP1.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span>Conforme o datasheet (</span><span class="c39 c34">colocar link</span><span class="c5">) um evento &eacute; definido neste modo como decorrente:</span></p><ul class="c80 lst-kix_pztu7jw0yxmt-0 start"><li class="c31"><span>de uma borda de descida </span><span class="c42 c39 c44 c50">(colocar imagem)</span></li><li class="c31"><span>de uma borda de subida </span><span class="c39">(colocar imagem)</span></li><li class="c31"><span>da 4&ordf; borda de subida </span><span class="c39">(colocar imagem)</span></li><li class="c31"><span>da 16&ordf; borda de subida </span><span class="c39">(colocar imagem)</span></li></ul><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O registrador CCP1CON &eacute; o registrador respons&aacute;vel pelo m&oacute;dulo CCP e neste episodio focaremos nele para o modo de captura.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O registrador CCP1ON &eacute; visto na Figura X1 abaixo</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c12"><span class="c34">Figura X1 -</span><span class="c5">Registrador CCP1ON</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 604.72px; height: 61.33px;"><img alt="" src="images/image75.png" style="width: 604.72px; height: 61.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">A primeira configura&ccedil;&atilde;o &eacute; feita tornando o pino RB3/CCp1 um pino de entrada.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Outra informa&ccedil;&atilde;o importante &eacute; que o modulo Timer1 &eacute; usado pelo modo capturar, conforme Figura X2</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c12"><span class="c34">Figura X2 -</span><span class="c5">Diagrama de bloco de opera&ccedil;&atilde;o do modo de captura</span></p><p class="c11"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 604.72px; height: 302.67px;"><img alt="" src="images/image55.png" style="width: 604.72px; height: 302.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Assim, para definir o comportamento do evento, utiliza-se a Tabela X1.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c12"><span class="c34">Tabela X1 -</span><span class="c5">Bits de sele&ccedil;&atilde;o do modo capturar</span></p><a id="t.046932ab868df5494f248b4a63d01780b671dfa1"></a><a id="t.153"></a><table class="c56"><tbody><tr class="c21"><td class="c202"><p class="c1"><span class="c26">CCP1M3</span></p></td><td class="c70"><p class="c1"><span class="c26">CCP1M2</span></p></td><td class="c194"><p class="c1"><span class="c26">CCP1M1</span></p></td><td class="c161"><p class="c1"><span class="c26">CCP1M0</span></p></td><td class="c120"><p class="c1"><span class="c26">Fun&ccedil;&atilde;o</td>
</tr>
<tr class="c21"><td class="c202"><p class="c1"><span class="c5">0</span></p></td><td class="c70"><p class="c1"><span class="c5">0</span></p></td><td class="c194"><p class="c1"><span class="c5">0</span></p></td><td class="c161"><p class="c1"><span class="c5">0</span></p></td><td class="c120"><p class="c1"><span class="c5">desliga o modo capturar</td>
</tr>
<tr class="c21"><td class="c202"><p class="c1"><span class="c5">0</span></p></td><td class="c70"><p class="c1"><span class="c5">1</span></p></td><td class="c194"><p class="c1"><span class="c5">0</span></p></td><td class="c161"><p class="c1"><span class="c5">0</span></p></td><td class="c120"><p class="c1"><span class="c5">modo capturar ativo com borda de descida</td>
</tr>
<tr class="c21"><td class="c202"><p class="c1"><span class="c5">0</span></p></td><td class="c70"><p class="c1"><span class="c5">1</span></p></td><td class="c194"><p class="c1"><span class="c5">0</span></p></td><td class="c161"><p class="c1"><span class="c5">1</span></p></td><td class="c120"><p class="c1"><span class="c5">modo capturar ativo com borda de subida</td>
</tr>
<tr class="c21"><td class="c202"><p class="c1"><span class="c5">0</span></p></td><td class="c70"><p class="c1"><span class="c5">1</span></p></td><td class="c194"><p class="c1"><span class="c5">1</span></p></td><td class="c161"><p class="c1"><span class="c5">0</span></p></td><td class="c120"><p class="c1"><span class="c5">modo capturar ativo com 4&ordf; borda de subida</td>
</tr>
<tr class="c21"><td class="c202"><p class="c1"><span class="c5">0</span></p></td><td class="c70"><p class="c1"><span class="c5">1</span></p></td><td class="c194"><p class="c1"><span class="c5">1</span></p></td><td class="c161"><p class="c1"><span class="c5">1</span></p></td><td class="c120"><p class="c1"><span class="c5">modo capturar ativo com 16&ordf; borda de subida</span></p></td></tr></tbody></table><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Timer1 deve estar executando no modo Timer ou contador sincronizado.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O tratamento da interrup&ccedil;&atilde;o associado a esse modo &eacute; no bit CCP1IF (bit do registrador PIR1) enquanto sua ativa&ccedil;&atilde;o &eacute; feita no bit CCP1IE (bit do registrador PIE1).</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c34">Exemplo:</span><span class="c5">C&aacute;lculo da frequencia da rede eletrica.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><hr style="page-break-before:always;display:none;">