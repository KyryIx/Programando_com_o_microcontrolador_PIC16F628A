<h1 class="c75 c35" id="h.fd6qc41zrstl"><span class="c28 c87"></span></h1><h1 class="c95 c35" id="h.mbompx2djc0b"><span class="c28 c87">Epis&oacute;dio 25: Conhecendo o Watchdog Timer (WDT) e a instru&ccedil;&atilde;o CLRWDT</span></h1><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Neste episodio veremos uma funcionalidade que &eacute; importante em aplica&ccedil;&otilde;es que n&atilde;o podem travar por longos periodos, permintindo resetar a aplica&ccedil;&atilde;o automaticamente.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Conforme datasheet (14.7 pagina 111) o Watchdog Timer (WDT) &eacute; um timer oscilador RC on-chip executando livremente, sem liga&ccedil;&atilde;o com o oscilador principal.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Outro fato importante&eacute; que o WDT varia conforme a temperatura por ser um oscilador RC, al&eacute;m de variar com a tens&atilde;o de alimenta&ccedil;&atilde;o.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O WDT tem um periodo limite normal de 18 ms, sem uso do Prescaler associado a ele conforme comentados nos episodios 3 e 13.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Pode-se modificar o periodo limite de tempo do WDT, aplicando Prescaler. Assim conforme episodio 3, o bit responsavel por selecionar qual periferico recebe o Prescaler, sabe-se que se PSA = 1, o Prescaler &eacute; atribuido ao Watchdog Timer e posterior taxa de incremento pelos bits PS&lt;2:0&gt; do registrador OPTION_REG, baseando-se na Tabela X1.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><a id="t.1fdd94494778b2d8601b556c5cd06f6486ac0949"></a><a id="t.160"></a><table class="c211"><tbody><tr class="c21"><td class="c93"><p class="c1"><span class="c26">PS2</span></p></td><td class="c93"><p class="c1"><span class="c26">PS1</span></p></td><td class="c93"><p class="c1"><span class="c26">PS0</span></p></td><td class="c198"><p class="c1"><span class="c26">Prescaler WDT</span></p></td><td class="c147"><p class="c1"><span class="c26">Periodo</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c198"><p class="c1"><span class="c5">1:1</span></p></td><td class="c147"><p class="c1"><span class="c5">18 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c198"><p class="c1"><span class="c5">1:2</span></p></td><td class="c147"><p class="c1"><span class="c5">36 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c198"><p class="c1"><span class="c5">1:4</span></p></td><td class="c147"><p class="c1"><span class="c5">72 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c198"><p class="c1"><span class="c5">1:8</span></p></td><td class="c147"><p class="c1"><span class="c5">144 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c198"><p class="c1"><span class="c5">1:16</span></p></td><td class="c147"><p class="c1"><span class="c5">288 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c198"><p class="c1"><span class="c5">1:32</span></p></td><td class="c147"><p class="c1"><span class="c5">576 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">0</span></p></td><td class="c198"><p class="c1"><span class="c5">1:64</span></p></td><td class="c147"><p class="c1"><span class="c5">1152 ms</td>
</tr>
<tr class="c21"><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c93"><p class="c1"><span class="c5">1</span></p></td><td class="c198"><p class="c1"><span class="c5">1:128</span></p></td><td class="c147"><p class="c1"><span class="c5">2304 ms</span></p></td></tr></tbody></table><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">O maior periodo limite &eacute; 128 * 18 ms = 2304 ms = 2,304 s.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Esse periodo &eacute; utilizado para reset caso o microcontrolador &ldquo;trave&rdquo;. Assim, se o Prescaler for 1:1, o periodo de reset por WDT &eacute; de 18 ms, necessitando resetar o periodo e para isso conheceremos a instru&ccedil;&atilde;o CLRWDT.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">A instru&ccedil;&atilde;o CLRWDT limpa o Watchdog Timer n&atilde;o permitindo o timer estourar e resetar o microcontrolador.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span>Caso haja um reset por WDT, o bit </span><span class="c59">TO</span><span class="c5">do registrador STATUS ser&aacute; limpo por causa do Watchdog Timer. A Figura X1 exibe o diagrama de blocos do processo do WDT.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c12"><span class="c34">Figura X1 -</span><span class="c5">Diagrama de blocos de Watchdog Timer</span></p><p class="c12"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 496.00px; height: 393.00px;"><img alt="" src="images/image19.png" style="width: 496.00px; height: 393.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">A ativa&ccedil;&atilde;o dele &eacute; feita no cabecalho do arquivo do prorama episodio 2.</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span class="c5">Agora se nouver necessidade de fazer isso em codigo &eacute; instra&ccedil;&atilde;o</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c12"><span class="c2">BSF CONFIG, WDTE  ; CONFIG esta no end. 0x2007</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11"><span>Exemplo de uso: </span><span class="c42 c39 c34 c50">--------------------</span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><p class="c11 c14"><span class="c5"></span></p><hr style="page-break-before:always;display:none;">